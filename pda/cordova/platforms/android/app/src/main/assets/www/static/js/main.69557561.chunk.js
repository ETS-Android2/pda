(this["webpackJsonppda-client"]=this["webpackJsonppda-client"]||[]).push([[0],{44:function(e,t,a){e.exports=a(64)},63:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(10),s=a.n(n),c=a(0),o=a.n(c),r=a(34),m=a.n(r),l=(a(43),a(1)),i=a(14),u=a(23),f=a(35),d={setAndroidApp:function(e,t){e.setState(Object(u.a)({},e.state,{androidApp:t}))},setAuthUser:function(e,t){e.setState(Object(u.a)({},e.state,{authUser:t}))},setLoadPage:function(e,t){e.setState(Object(u.a)({},e.state,{loadPage:t}))}},p=Object(f.a)(o.a,{androidApp:!1,authUser:null,loadPage:!1},d),h=a(4);var E,b=Object(i.g)(Object(h.b)()((function(){var e=p(),t=Object(l.a)(e,2)[1],a=Object(c.useState)(!1),n=Object(l.a)(a,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){t.setLoadPage(!1)}),[]),s?o.a.createElement(i.a,{to:"/Inventory"}):o.a.createElement("section",{className:"famo-wrapper"},o.a.createElement("div",{className:"famo-content"},o.a.createElement("div",{className:"famo-grid"},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell text-center"},o.a.createElement("button",{type:"button",className:"famo-button famo-normal-button",onClick:function(e){r(!0)}},o.a.createElement("span",{className:"famo-text-5"},"Invent\xe1rio")))))))}))),v=a(12),N=a.n(v);!function(e){e[e.productInput=1]="productInput"}(E||(E={}));var g=Object(h.b)()((function(e){var t=e.contentType,a=e.visible,n=e.setVisible,s=e.confirm,r=e.t,m=Object(c.useState)(a),i=Object(l.a)(m,2),u=i[0],f=i[1],d=Object(c.useState)(""),p=Object(l.a)(d,2),h=p[0],b=p[1],v=[b];function N(){switch(t){case E.productInput:s(h)}n(!1)}function g(e){e.preventDefault(),N()}function y(e){N()}function w(e){n(!1)}return Object(c.useEffect)((function(){f(a),a||v.forEach((function(e){e("")}))}),[a]),o.a.createElement("section",{className:"w3-modal famo-modal"+(u?" w3-show":""),onClick:function(e){n(!1)}},o.a.createElement("div",{className:"w3-modal-content famo-modal-content",onClick:function(e){e.stopPropagation()}},function(){switch(t){case E.productInput:return o.a.createElement("section",{className:"famo-wrapper"},o.a.createElement("div",{className:"famo-content"},o.a.createElement("form",{className:"famo-grid famo-form-grid famo-submit-form",noValidate:!0,onSubmit:g},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},r("key_87"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"productCode",value:h,onInput:function(e){return b(e.target.value)}}))),o.a.createElement("input",{type:"submit",className:"hide",value:""})),o.a.createElement("div",{className:"famo-grid famo-buttons"},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell text-right"},o.a.createElement("button",{type:"button",className:"famo-button famo-confirm-button",onClick:y},o.a.createElement("span",{className:"famo-text-12"},r("key_701"))),o.a.createElement("button",{type:"button",className:"famo-button famo-cancel-button",onClick:w},o.a.createElement("span",{className:"famo-text-12"},r("key_484"))))))))}}()),o.a.createElement("div",{className:"famo-buttons"},o.a.createElement("button",{type:"button",className:"famo-button famo-icon-button",title:r("key_200"),onClick:function(e){e.stopPropagation(),n(!1)}},o.a.createElement("span",{className:"fas fa-times"}))))}));function y(e){var t=e.hide;return o.a.createElement("div",{className:"famo-loader-wrapper"+(t?" hide":"")},o.a.createElement("div",{className:"famo-loader"}))}var w="pda",O="http://cpu-244.famo.pt:3030/";function k(e){fetch(O+"Log/Http/Errors?appName="+w+"&timestamp="+(new Date).getTime(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e.status,statusText:e.statusText,url:e.url}),credentials:"include"}).then((function(){})).catch((function(){}))}function j(e){fetch(O+"Log/Promise/Errors?appName="+w+"&timestamp="+(new Date).getTime(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.message,stack:e.stack,request:e.request?{method:e.request.method,path:e.request.path}:null,response:e.response?{status:e.response.status}:null}),credentials:"include"}).then((function(){})).catch((function(){}))}var x=Object(i.g)(Object(h.b)()((function(e){var t=e.t,a=Object(c.useState)(""),n=Object(l.a)(a,2),s=n[0],r=n[1],m=Object(c.useState)([]),i=Object(l.a)(m,2),u=i[0],f=i[1],d=Object(c.useState)(!1),h=Object(l.a)(d,2),b=h[0],v=h[1],w=Object(c.useState)(!1),x=Object(l.a)(w,2),C=x[0],S=x[1],I=Object(c.useState)(null),P=Object(l.a)(I,2),_=P[0],T=P[1],A=Object(c.useState)(),D=Object(l.a)(A,2),M=D[0],U=D[1],L=p(),V=Object(l.a)(L,2),F=V[0],H=V[1];function R(e){var a=e.split("/"),n=a[0],c="";a.length>1&&(c=a[1]),S(!0),fetch(O+"ERP/Inventories/Products?inventoryCode="+s+"&productCode="+n+"&productVariantCode="+c+"&timestamp="+(new Date).getTime(),{method:"GET",credentials:"include"}).then((function(e){e.ok&&e.status===N.a.OK?e.json().then((function(e){T(e)})).catch((function(e){T(null),j(e),alert(t("key_416"))})):(T(null),k(e),alert("O c\xf3digo n\xe3o corresponde a um produto do invent\xe1rio."))})).catch((function(e){T(null),j(e),alert(t("key_416"))})).finally((function(){S(!1)}))}return Object(c.useEffect)((function(){H.setLoadPage(!0)}),[]),Object(c.useEffect)((function(){F.authUser&&fetch(O+"ERP/Inventories?timestamp="+(new Date).getTime(),{method:"GET",credentials:"include"}).then((function(e){e.ok&&e.status===N.a.OK?e.json().then((function(e){f(e),H.setLoadPage(!1)})).catch((function(e){j(e),alert(t("key_416"))})):(k(e),alert(t("key_303")))})).catch((function(e){j(e),alert(t("key_416"))}))}),[F.authUser]),Object(c.useEffect)((function(){""===s&&T(null)}),[s]),o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"famo-wrapper"},o.a.createElement("div",{className:"famo-content"},o.a.createElement("form",{className:"famo-grid famo-form-grid",noValidate:!0,onSubmit:function(e){return e.preventDefault()}},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},"Invent\xe1rio")),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("select",{className:"famo-input famo-text-10",name:"inventoryCode",disabled:C,onChange:function(e){r(e.target.value)}},o.a.createElement("option",{key:""}),u.map((function(e,t){return o.a.createElement("option",{key:t,value:e.Code},e.Name)})))))))),_||C?o.a.createElement("section",{className:"famo-wrapper"},o.a.createElement("div",{className:"famo-title"},o.a.createElement("span",{className:"famo-text-13"},t("key_339"))),o.a.createElement("div",{className:"famo-content"},o.a.createElement(y,{hide:!C}),o.a.createElement("form",{className:"famo-grid famo-form-grid"+(C?" hide":""),noValidate:!0,onSubmit:function(e){return e.preventDefault()}},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},t("key_87"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"productCode",disabled:!0,value:_?_.ProductCode:""}))),o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},t("key_464"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"productVariantCode",disabled:!0,value:_?_.ProductVariantCode:""}))),o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},t("key_138"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"productDescription",disabled:!0,value:_?_.ProductDescription:""}))),o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},t("key_751"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"locationCode",disabled:!0,value:_?_.LocationCode:""}))),o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-input-label"},o.a.createElement("span",{className:"famo-text-11"},t("key_347"))),o.a.createElement("div",{className:"famo-cell"},o.a.createElement("input",{type:"text",className:"famo-input famo-text-10",name:"quantity","data-sub-type":"number"}),o.a.createElement("div",{className:"famo-input-message hide"},o.a.createElement("span",{className:"famo-text-15"},t("key_13")))))),o.a.createElement("div",{className:"famo-grid famo-buttons"+(C?" hide":"")},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell text-right"},o.a.createElement("button",{type:"button",className:"famo-button famo-confirm-button",onInput:function(e){return U(e.target.value)},onClick:function(e){fetch(O+"ERP/Inventories/Products"+function(e){var t="?timestamp="+(new Date).getTime();for(var a in e){var n=e[a];if(Array.isArray(n))for(var s=0,c=n.length;s<c;s++)t+="&"+a+"="+(null===n[s]?"":encodeURIComponent(n[s]));else t+="&"+a+"="+(null===n?"":encodeURIComponent(n))}return t}({documentCode:_.Code,productCode:_.ProductCode,productVariantCode:_.ProductVariantCode,locationCode:_.LocationCode,quantity:M}),{method:"PATCH",credentials:"include"}).then((function(e){e.ok||(k(e),alert(t("key_302")))})).catch((function(e){j(e),alert(t("key_416"))})).finally((function(){}))}},o.a.createElement("span",{className:"famo-text-12"},"Registar"))))))):null,s?o.a.createElement("section",{className:"famo-wrapper"},o.a.createElement("div",{className:"famo-grid"},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell text-right"},o.a.createElement("button",{type:"button",className:"famo-button famo-normal-button",disabled:C,onClick:function(e){v(!0)}},o.a.createElement("span",{className:"famo-text-12"},"Manual")),F.androidApp?o.a.createElement("button",{type:"button",className:"famo-button famo-normal-button",disabled:C,onClick:function(e){window.cordova.plugins.barcodeScanner.scan((function(e){e.cancelled||R(e.text)}),(function(e){alert(t("key_686"))}),{preferFrontCamera:!1,showFlipCameraButton:!1,showTorchButton:!0,torchOn:!1,saveHistory:!1,prompt:"",resultDisplayDuration:0,formats:"CODE_39",orientation:"unset",disableAnimations:!0,disableSuccessBeep:!1,continuousMode:!1})}},o.a.createElement("span",{className:"famo-text-12"},t("key_681"))):null)))):null,o.a.createElement(g,{contentType:E.productInput,visible:b,setVisible:v,confirm:R}))}))),C=a(17),S=a(20),I=a(28),P=a(30),_=a(29),T=a(31);function A(e,t,a){fetch(O+"Platform/Android?timestamp="+(new Date).getTime(),{method:"GET",credentials:"include"}).then((function(n){n.ok&&n.status===N.a.OK?n.json().then((function(a){t.setAndroidApp(a),t.setAuthUser(e)})).catch((function(e){j(e),alert(a("key_416"))})):(k(n),alert(a("key_303")))})).catch((function(e){j(e),alert(a("key_416"))}))}function D(e,t){M.autoSignIn().then((function(a){a.ok&&a.status===N.a.OK?a.json().then((function(a){A(a,e,t)})).catch((function(e){j(e),alert(t("key_416"))})):(k(a),alert(t("key_306")))})).catch((function(e){j(e),alert(t("key_416"))}))}var M=function e(){Object(S.a)(this,e)};M.signIn=function(e,t){return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",fetch(O+"Authentication/SignIn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t}),credentials:"include"}));case 1:case"end":return a.stop()}}))},M.autoSignIn=function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(O+"Authentication/AutoSignIn?timestamp="+(new Date).getTime(),{method:"GET",credentials:"include"}));case 1:case"end":return e.stop()}}))},M.signOut=function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(O+"Authentication/SignOut",{method:"GET",credentials:"include"}));case 1:case"end":return e.stop()}}))};var U=a(24),L=a.n(U),V=a(42),F=a(41);V.a.use(F.a).use(h.a).init({lng:"pt",fallbackLng:"pt",whitelist:["pt","en","es","fr"],debug:!1,react:{useSuspense:!1},backend:{loadPath:"./JSON/i18n/{{lng}}.json?timestamp="+(new Date).getTime(),crossDomain:!0}});var H=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(P.a)(this,Object(_.a)(t).call(this,e))).usernameInput=void 0,a.hideInputMsg=function(e){return"signin-error-input"+(e?" hide":"")},a.handleChangeInput=function(e){a.setState(Object(C.a)({},e.target.name,e.target.value))},a.handleUserInput=function(e){e.target.value||a.setState({hideUserMsg:"blur"!==e.type})},a.handlePwdInput=function(e){e.target.value||a.setState({hidePwdMsg:"blur"!==e.type})},a.handleSubmit=function(e){var t,n,c,o,r,m;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.preventDefault(),t=p(),n=Object(l.a)(t,2),c=n[1],a.state.username&&a.state.password){i.next=6;break}a.setState({hideUserMsg:!!a.state.username,hidePwdMsg:!!a.state.password}),i.next=24;break;case 6:return i.next=8,s.a.awrap(M.signIn(a.state.username,a.state.password));case 8:if(o=i.sent,r=a.props.t,a.setState({authError:!1,authHttpCode:-1}),!o.ok){i.next=20;break}return a.setState({authSuccess:!0}),i.t0=c,i.next=16,s.a.awrap(o.json());case 16:i.t1=i.sent,i.t0.setAuthUser.call(i.t0,i.t1),i.next=24;break;case 20:400!==(m=o.status)&&500!==m&&console.log(r("key_416")+" - "+m),a.usernameInput.current.focus(),a.setState({password:"",hidePwdMsg:!0,authError:!0,authHttpCode:m});case 24:case"end":return i.stop()}}))},a.state={username:"",password:"",hideUserMsg:!0,hidePwdMsg:!0,authSuccess:!1,authError:!1,authHttpCode:-1},a.usernameInput=o.a.createRef(),a}return Object(T.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.usernameInput.current.focus()}},{key:"render",value:function(){var e=L()("famo-input signin-form-input famo-text-3",{"famo-input-error":!this.state.hideUserMsg}),t=L()("famo-input signin-form-input famo-text-3",{"famo-input-error":!this.state.hidePwdMsg}),a=L()("signin-error-submit",{hide:!this.state.authError}),n=this.props,s=n.t,c=n.location;return this.state.authSuccess?o.a.createElement(i.a,{to:c.state||{from:{pathname:"/"}}}):o.a.createElement("section",{className:"famo-grid signin"},o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell"},o.a.createElement("div",{className:"signin-body"},o.a.createElement("div",{className:"signin-famo-logo"},o.a.createElement("img",{src:"http://www.famo-code.com/Content/Images/logo-famo-black-normal.png",alt:"FAMO"})),o.a.createElement("div",{className:"signin-form"},o.a.createElement("div",{className:"signin-app-name"},o.a.createElement("span",{className:"famo-text-2"},"PDA")),o.a.createElement("form",{id:"signin-form",method:"POST",onSubmit:this.handleSubmit},o.a.createElement("div",{className:"signin-input-wrapper"},o.a.createElement("input",{type:"text",id:"signin-username-input",className:e,placeholder:s("key_397"),ref:this.usernameInput,name:"username",value:this.state.username,autoComplete:"off",onChange:this.handleChangeInput,onFocus:this.handleUserInput,onBlur:this.handleUserInput}),o.a.createElement(R,{msgClass:this.hideInputMsg(this.state.hideUserMsg),msgText:s("key_196")})),o.a.createElement("div",{className:"signin-input-wrapper"},o.a.createElement("input",{type:"password",id:"signin-password-input",className:t,placeholder:s("key_314"),name:"password",value:this.state.password,onChange:this.handleChangeInput,onFocus:this.handlePwdInput,onBlur:this.handlePwdInput}),o.a.createElement(R,{msgClass:this.hideInputMsg(this.state.hidePwdMsg),msgText:s("key_195")})),o.a.createElement("div",{className:a},this.state.authError&&400===this.state.authHttpCode&&o.a.createElement("span",{className:"famo-text-7"},s("key_398")),this.state.authError&&500===this.state.authHttpCode&&o.a.createElement("span",{className:"famo-text-7"},s("key_306"))),o.a.createElement("button",{className:"famo-button famo-confirm-button signin-button-submit",type:"submit"},o.a.createElement("span",{className:"famo-text-5"},s("key_238"))),o.a.createElement("button",{type:"button",className:"famo-button famo-transparent-button signup-button"},o.a.createElement("span",{className:"famo-text-27"},s("key_648")))))))),o.a.createElement("div",{className:"famo-row"},o.a.createElement("div",{className:"famo-cell famo-cell-bottom"},o.a.createElement("div",{className:"signin-footer text-center"},o.a.createElement("span",{className:"famo-text-1"},(new Date).getFullYear()," \xa9 FAMO - ","PDA")))))}}]),t}(o.a.Component),R=function(e){function t(){return Object(S.a)(this,t),Object(P.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.msgClass,a=e.msgText;return o.a.createElement("div",{className:t},o.a.createElement("span",{className:"famo-text-7"},a))}}]),t}(o.a.Component),q=(Object(h.b)()(H),a(16));a(63);function B(e){var t=e.t,a=p(),n=Object(l.a)(a,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){fetch(O+"Authentication/Session/User",{method:"GET",credentials:"include"}).then((function(e){e.ok&&e.status===N.a.OK?e.json().then((function(e){A(e,r,t)})).catch((function(e){D(r,t),j(e)})):(D(r,t),k(e))})).catch((function(e){D(r,t),j(e)}))}),[]),o.a.createElement("section",{className:"famo-body"},o.a.createElement("div",{className:"pda-app-loader"+(s.authUser&&!s.loadPage?" hide":"")},o.a.createElement("div",{className:"famo-loader"})),o.a.createElement(i.d,null,o.a.createElement(i.b,{exact:!0,path:"/"},o.a.createElement(b,null)),o.a.createElement(i.b,{path:"/Inventory"},o.a.createElement(x,null))))}var G=Object(h.b)()((function(e){return window.cordova?o.a.createElement(q.b,null,o.a.createElement(B,e)):o.a.createElement(q.a,null,o.a.createElement(B,e))}));function J(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:try{m.a.render(o.a.createElement(G,null),document.getElementById("root"))}catch(t){alert("Oops!! Liga o servidor Node.js!")}case 1:case"end":return e.stop()}}))}window.cordova?document.addEventListener("deviceready",J,!1):J()}},[[44,1,2]]]);